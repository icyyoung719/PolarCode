function u = GA(sigma, N)
%   基于高斯近似估算极化码信道质量信息
%   sigma - 高斯信道噪声标准差
%   N - 极化码的码长（必须为 2 的幂次）
%   u - 信道质量信息（每个信道的 LLR 期望值）

% 初始化信道质量数组 u
u = zeros(1, N);           % 信道质量初始为全零
u(1) = 2 / sigma^2;        % 初始信道质量值（根据信噪比计算）

% 递归计算每个信道的 LLR 期望值
for i = 1:log2(N)          % 循环层数，对应递归深度
    j = 2^(i - 1);         % 当前层中需要更新的信道对数量
    for k = 1:j            % 遍历当前层的所有信道对
        tmp = u(k);        % 取出当前信道的 LLR 值
        % 通过 phi 函数计算上层的信道质量
        u(k) = phi_inverse(1 - (1 - phi(tmp))^2); % 信道合并（极化）的左分支
        u(k + j) = 2 * tmp;                       % 信道合并（极化）的右分支
    end
end

% 对结果进行位反转排序
% 保证信道编号与极化码编码过程中的比特翻转匹配
u = bitrevorder(u);       

end
